<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<!-- Edit me start! -->
		<title>Love your data</title>
		<meta name="description" content=" Data & Reproducibility Management with DataLad ">
		<meta name="author" content=" Adina Wagner ">
		<!-- Edit me end! -->

		<link rel="stylesheet" href="../reveal.js/dist/reset.css">
		<link rel="stylesheet" href="../reveal.js/dist/reveal.css">
		<link rel="stylesheet" href="../reveal.js/dist/theme/beige.css">
        <link rel="stylesheet" href="../css/main.css">
		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="../reveal.js/plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

  <!--...Datalad Basics...-->

  <section>


<section>
<h2>Data and Reproducibility Management with DataLad</h2>

  <div style="margin-top:1em;text-align:center">
  <table style="border: none;">
  <tr>
	<td style="border: none;">Adina Wagner
	  <br><small>
		<a href="https://mas.to/@adswa" target="_blank">
		  <img data-src="../pics/mastodon.svg" style="height:30px;margin:0px" />
		  mas.to/@adswa</a></small></td>
    <td style="border: none;">
	  <br></td>
  </tr>
  <tr>
    <td style="border: none; vertical-align:top">
        <small><a href="http://psychoinformatics.de" target="_blank">Psychoinformatics lab</a>,
          <br> Institute of Neuroscience and
          Medicine, Brain &amp; Behavior (INM-7)<br>
       Research Center Jülich</small><br>
    </td>
      <td><img style="height:100px;margin-right:10px" data-src="../pics/fzj_logo.png" /></td>
  </tr>
  </table>
  </div>
        <p style="z-index: 100;position: fixed;background-color:#ede6d5;font-size:35px;box-shadow: 10px 10px 8px #888888;margin-top:0px;margin-bottom:100px;margin-left:1000px">
        <img src="../pics/qr_lovedata.png" height="200">
    </p>
<br><br><small>

    Slides: <a href="https://doi.org/10.5281/zenodo.7627723" target="_blank">
    DOI 10.5281/zenodo.7627723</a> (Scan the QR code)
</small>


</a>
</section>


  <section>
  <h2>Logistics</h2>
  <ul style="font-size:35px">
      <li class="fragment fade-in">
          Collaborative, public notes, networking, & anonymous questions at <a href="https://etherpad.wikimedia.org/p/love-your-data-datalad" target="_blank">
          etherpad.wikimedia.org/p/love-your-data-datalad</a>
      </li>
      <br>
      <li class="fragment fade-in">
          We are using a JupyterHub at <a href="https://datalad-hub.inm7.de" target="_blank">datalad-hub.inm7.de</a>.
          Your username is the email you registered with e.g., a.wagner@fz-juelich.de → a.wagner <br>
          You can log in with a password of your choice.
      </li>
      <br>

      <li class="fragment fade-in">
          Format:
      </li>
      <ul class="fragment fade-in">
          <li>Mostly hands-on: Watch me live-code, and try out the software
              yourself in the browser</li>
          <li>Ask questions any time! </li>
          <li>Proper Zoom etiquette: Please mute yourself when you don't speak &
              make use of the "Raise hand" feature</li>
          <li>Quick ☕ break after 1 hour</li>
      </ul>
  </ul>
  </section>

  <section>
      <h2>Further resources and stay in touch</h2>
      <ul>
              If you have questions after the workshop, reach out:
          <br>
          <ul style="font-size:30px">
              <dt>Reach out to to the <b>DataLad</b> team via</dt>
            <li>
                <a href="https://matrix.to/#/!NaMjKIhMXhSicFdxAj:matrix.org?via=matrix.waite.eu&via=matrix.org&via=inm7.de" target="_blank">
                    Matrix</a> (free, decentralized communication app, no app needed).
                    We run a weekly Zoom office hour (Tuesday, 4pm Berlin time) from this room as well.
            </li>
            <li>
                <a href="https://github.com/datalad/datalad" target="_blank">
                the development repository on GitHub</a>
            </li>
              <br>
              <dt>Reach out to the user community with</dt>
              <li>A question on <a href="https://neurostars.org/" target="_blank">neurostars.org</a>
              with a <code>datalad</code> tag</li>
              <br>
              <dt>Find more user tutorials or workshop recordings</dt>
              <li>On <a href="https://www.youtube.com/channel/datalad" target="_blank">
                  DataLad's YouTube channel</a>
              </li>
              <li>
                  In the <a href="http://handbook.datalad.org/en/latest/" target="_blank">
                  DataLad Handbook </a>
              </li>
              <li>In the <a href="https://psychoinformatics-de.github.io/rdm-course/" target="_blank">DataLad RDM course</a> </li>
              <li>In the <a href="http://docs.datalad.org" target="_blank">Official API documentation</a> </li>
              <li> In an overview of most tutorials, talks, videos at
              <a href="https://github.com/datalad/tutorials" target="_blank">github.com/datalad/tutorials</a> </li>
          </ul>
      </ul>
  </section>

  <section>
      <h2>Let's get to know each other</h2>
      Please use your phone to scan to QR code, or open the link in a new browser window <br>
          <iframe src="https://www.directpoll.com/r?XDbzPBd3ixYqg8VRC7Mz8FH4nJ3iEPxTGiMZyeyf",
              style="border: 0" width="900" height="800"></iframe>
  </section>
</section>



<!-------Examples-------->

<section>

<section data-transition="None">
    <h2>A common usecase</h2>
    <div style="margin-top:0.5em;">
        <table style="border: none;table-layout: fixed;">
            <tr>
                <td width="60%"><img style="height:500px; margin-top: 0; margin-right:1px;vertical-align:middle;" data-src="../pics/comic_box1.svg" /></td>
                <td>
                    <ul style="vertical-align:middle;">
                        <li class="fragment fade-in">
                            Alice is a PhD student in a research team.</li>
                        <li class="fragment fade-in">
                            She works on a fairly typical research project:
                            Data collection & processing.</li>
                        <li class="fragment fade-in">
                            First sample → final result = complex process</li>
                    </ul>
                </td>
            </tr>
        </table>
    </div><br>
    <h3 class="fragment fade-in">How does Alice go about her daily job?</h3>
</section>


<section data-transition="None">
    <h2>A common usecase</h2>
    <ul>
        <li class="fragment fade-in">
            In her project, Alice likes to have an automated record of:
            <ul>
                <li>when a given file was last changed</li>
                <li>where it came from</li>
                <li>what input files were used to generate a given output</li>
                <li>why some things were done.</li>
            </ul>
        </li>
        <br>
        <li class="fragment fade-in">
            Even if she doesn't share her work, this is essential for her future self</li>
        <li class="fragment fade-in">
            Her project is exploratory: Frequent changes to her analysis scripts</li>
        <li class="fragment fade-in">
            She enjoys the comfort of being able to return to a previously recorded state</li>
    </ul>
    <br><br>
    <h3 class="fragment fade-in">This is: *local version control*</h3>
</section>


<section data-transition="None">
    <h2>A common usecase</h2>
    <ul>
        <li class="fragment fade-in" data-fragment-index="1">
            Alice's work is not confined to a single computer:
            <ul>
                <li>Laptop / desktop / remote server / dedicated back-up</li>
                <li>Alice wants to automatically & efficiently synchronize</li>
            </ul>
        </li>
        <br>
        <li class="fragment fade-in" data-fragment-index="2">
            Parts of the data are collected or analyzed by colleagues.
            This requires:
            <ul>
                <li>distributed synchronization with centralized storage</li>
                <li>preservation of origin & authorship of changes</li>
                <li>effective combination of simultaneous contributions</li>
            </ul>
        </li>
    </ul>
    <br><br>
    <h3 class="fragment fade-in" data-fragment-index="3">This is: *distributed version control*</h3>
</section>


<section data-transition="None">
    <h2>A common usecase</h2>
    <ul>
        <li class="fragment fade-in">
            Alice applies local version control for her own work, and reproducibly records it
        </li>
        <li class="fragment fade-in">
            She also applies distributed version control when working with colleagues
            and collaborators
        </li>
        <li class="fragment fade-in">
            She often needs to work on a subset of data at any given time:
            <ul>
                <li>all files are kept on a server</li>
                <li>a few files are rotated into and out of her laptop</li>
            </ul>
        </li>
        <li class="fragment fade-in">
            Alice wants to publish the data at project's end:
            <ul>
                <li>raw data / outputs / both</li>
                <li>completely or selectively</li>
            </ul>
        </li>
    </ul>
    <br><br>
    <h3 class="fragment fade-in">This is: *data management (with DataLad 😀)*</h3>
</section>
</section>

<section>
<section>
    <h2>DataLad</h2>
            <img style="height:300px; margin-top: 0; margin-right:1px;vertical-align:middle;" src="../pics/comic_box3.svg" alt="">
    <br>
                    <ul style="font-size:37px">
                        <li>Domain-agnostic <strong>command-line tool</strong>
                            (+ <strong>graphical user interface</strong>),
            <br>built on top of <a href="https://git-scm.com/" target="_blank">Git</a>
            & <a href="https://git-annex.branchable.com/" target="_blank">Git-annex</a></li>
        <li>Major features:</li>
        <dt>Version-controlling arbitrarily large content </dt>
        <dd>Version control data & software alongside to code!</dd>
        <dt>Transport mechanisms for sharing & obtaining data </dt>
        <dd>Consume & collaborate on data (analyses) like software</dd>
        <dt>(Computationally) reproducible data analysis</dt>
        <dd>Track and share provenance of all digital objects</dd>
        <dt>(... and <i>much</i> more) </dt>
        <br>
    </ul>


</section>


<section>
    <h2>Let's try it out</h2>
    <img src="../pics/jupyterhub-login.png">
    <dl style="font-size:30px">
    <dt>username:</dt>
    <dd>email without <code>@domain</code> (a.wagner@fz-juelich.de -> a.wagner)<br>
    (must be the email you registered with for this workshop)</dd>
    <dt>password:</dt>
    <dd>Set at first login, at least 8 characters</dd>
        </dl>
    <p class="fragment fade-in"><strong>Important!</strong> The Hub is a shared resource. Don't fill it up :)</p>
</section>
<section style="text-align: left;">
    <h3>datalad</h3>

    Check the installed version:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            datalad --version
        </code>
        <p id="displayArea"></p>
    </pre>

    <div class="fragment">
        For help on using DataLad from the command line:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad --help
            </code>
            The help may be displayed in a pager - exit it by pressing "q"
        </pre>
    </div>

    <div class="fragment">
        For extensive info about the installed package, its dependencies, and extensions, use <code>wtf</code>:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad wtf
            </code>
        </pre>
    </div>
</section>


<section style="text-align: left;">
    <h3>Git identity</h3>
    Check Git identity:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            git config --get user.name
            git config --get user.email
        </code>
    </pre>

    <div class="fragment">
        Configure Git identity:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                git config --global user.name "Adina Wagner"
                git config --global user.email "adina.wagner@t-online.de"
            </code>
        </pre>
    </div>
</section>


<section style="text-align: left;">
    <h3>Using datalad via its Python API</h3>
    Open a Python environment:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            ipython
        </code>
    </pre>
    <div class="fragment">
        Import and start using:
        <pre style="margin-left: 0;">
            <code data-trim class="language-python" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                import datalad.api as dl
                dl.create(path='mydataset')
            </code>
        </pre>
    </div>
    <div class="fragment">
        Exit the Python environment:
        <pre style="margin-left: 0;">
            <code data-trim class="language-python" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                exit
            </code>
        </pre>
    </div>
</section>
</section>

<section>
<section>
    <h3 style="text-align: left;">Datalad datasets...</h3>
    <img src="../pics/comic_box4.svg" alt="">
</section>


<section style="text-align: left;">
    <h3>...Datalad datasets</h3>
    Create a dataset (here, with the <code>yoda</code> config):
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            datalad create -c yoda my-analysis
        </code>
    </pre>

    <div class="fragment">
        Let's have a look inside. Navigate using <code>cd</code> (change directory):
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                cd my-analysis
            </code>
        </pre>
    </div>

    <div class="fragment">
        List the directory content, including hidden files, with <code>ls</code>:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                ls -la .
            </code>
        </pre>
    </div>
</section>
</section>

<section>
<section>
    <h3 style="text-align: left;">Version control...</h3>
    <img src="../pics/comic_box5.svg" alt="">
</section>


<section style="text-align: left;">
    <h3>...Version control</h3>
    Let's add some Markdown text to a README file in the dataset
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            echo "# My example DataLad dataset" > README.md
        </code>
    </pre>

    <div class="fragment">
        Now we can check the <code>status</code> of the dataset:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad status
            </code>
        </pre>
    </div>

    <div class="fragment">
        We can save the state with <code>save</code>
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad save -m "Add project title into the README"
            </code>
        </pre>
    </div>

    <div class="fragment">
        Further modifications:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                echo "Contains a small data analysis for my project" >> README.md
            </code>
        </pre>
    </div>

    <div class="fragment">
        Save again:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad save -m "Add information on the dataset contents to the README"
            </code>
        </pre>
    </div>
</section>

<section  style="text-align: left;">
    <h3>...Version control</h3>
        <div class="fragment">
        Now, let's check the dataset history:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                git log
            </code>
        </pre>
    </div>

    <div class="fragment">
        We can also make the history prettier:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                tig
            </code>
            (navigate with arrow keys and enter, press "q" to go back and exit the program)
        </pre>
    </div>

    <div class="fragment">
        Convenience functions make downloads easier. Let's add code for a data analysis from an external source:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">datalad download-url -m "Add an analysis script" \
  -O code/classification_analysis.py \
  https://raw.githubusercontent.com/datalad-handbook/resources/master/classification_analysis.py
            </code>
        </pre>
    </div>

    <div class="fragment">
        Check out the file's history:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">git log code/classification_analysis.py</code>
        </pre>
    </div>
</section>

  <section>
      <h2>Local version control</h2>

      <p>Procedurally, version control is easy with DataLad!</p>
      <img class="fragment fade-in" src="../pics/local_wf.svg" height="500"> <!-- .element: class="fragment" -->
      <br>

      <b class="fragment fade-in">Advice:</b>
      <ul>
        <li class="fragment fade-in">Save <i>meaningful</i> units of change</li>
        <li class="fragment fade-in">Attach helpful commit messages</li>
      </ul>
  </section>
</section>

<section>
<section>
    <h3 style="text-align: left;">Computationally reproducible execution I...</h3>
    <img src="../pics/comic_box7.svg" width="65%" alt="">
    <ul>
        <li class="fragment fade-in-then-semi-out">which script/pipeline version</li>
        <li class="fragment fade-in-then-semi-out">was run on which version of the data</li>
        <li class="fragment fade-in-then-semi-out">to produce which version of the results?</li>
    </ul>
</section>

<section style="text-align:left;">
    <h3>... Computationally reproducible execution I</h3>
    <div class="fragment">
        A variety of processes can modify files. A simple example: Code formatting
            <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">black code/classification_analysis.py</code>
        </pre>
    </div>

    <div class="fragment">
        Version control makes changes transparent:
            <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">git diff</code>
        </pre>
    </div>

    <div class="fragment">
        But its useful to keep track beyond that. Let's discard the latest changes...
            <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">git restore code/classification_analysis.py</code>
        </pre>
    </div>

    <div class="fragment">
        ... and record precisely what we did
            <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">datalad run -m "Reformat code with black" \
 "black code/classification_analysis.py"</code>
        </pre>
    </div>

    <div class="fragment">
        let's take a look:
            <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">git show</code>
        </pre>
    </div>

    <div class="fragment">
        ... and repeat!
            <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">datalad rerun</code>
        </pre>
    </div>
</section>
</section>

<section>
<section>
    <h3 style="text-align: left;">Data consumption & transport...</h3>
    <img src="../pics/comic_box6_consumption.svg" alt="">
</section>


<section style="text-align: left;">
    <h3>...Data consumption & transport...</h3>

    You can install a dataset from remote URL (or local path) using <code>clone</code>.
    Either as a stand-alone entity:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" >
            # just an example:
            datalad clone \
            https://github.com/psychoinformatics-de/studyforrest-data-phase2.git
        </code>
    </pre>

    <div class="fragment">
        Or as linked dataset, nested in another dataset in a superdataset-subdataset hierarchy:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" >
            # just an example:
            datalad clone -d . \
            https://github.com/psychoinformatics-de/studyforrest-data-phase2.git
        </code>
    </pre>
    <img src="../pics/linkage_subds.png" alt="">
    </div>
    <ul style="font-size:30px" class="fragment">
        <li>Helps with scaling (see e.g. the <a href="https://github.com/datalad-datasets/human-connectome-project-openaccess">Human Connectome Project dataset</a> )</li>
        <li>Version control tools struggle with >100k files</li>
        <li>Modular units improves intuitive structure and reuse potential</li>
        <li>Versioned linkage of inputs for reproducibility</li>
    </ul>
</section>


<section style="text-align: left;">
    <h3>...Dataset nesting</h3>

    Let's make a nest!
    <div class="fragment">
        We clone a dataset with data for an analysis into a specific
        location in the file tree of the existing dataset ("input"),
        making it a <em>sub</em>dataset:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad clone --dataset . \
                https://github.com/datalad-handbook/iris_data.git \
                input/
            </code>
        </pre>
    </div>

    <div class="fragment">
        Let's see what changed in the dataset, using the <code>subdatasets</code> command:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad subdatasets
            </code>
        </pre>
    </div>
    <div class="fragment">
        ... and also <code>git show</code>:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                git show
            </code>
        </pre>
    </div>
</section>

<section style="text-align:left;">
    <div class="fragment">
        We can now view the cloned dataset's file tree:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                cd input
                ls
            </code>
        </pre>
    </div>

    <div class="fragment">
        ...and also its history
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                tig
            </code>
        </pre>
    </div>

    <div class="fragment">
        Let's check the dataset size (with the <code>du</code> disk-usage command):
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                du -sh
            </code>
        </pre>
    </div>

    <div class="fragment">
        Let's check try to print the file contents into the terminal (<code>cat</code>):
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                cat iris.csv
            </code>
        </pre>
    </div>

    <div class="fragment">
        Let's check the <em>actual</em> dataset size:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad status --annex
            </code>
        </pre>
    </div>

</section>



<section style="text-align: left;">
    <h3>...Data consumption & transport</h3>

    We can retrieve actual file content with <code>get</code>:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            datalad get iris.csv
        </code>
    </pre>

    <div class="fragment">
        If we don't need a file locally anymore, we can <code>drop</code> its content:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad drop iris.csv</code>
        </pre>
    </div>

    <div class="fragment">
        Therefore: no need to store all files locally.
        Data just needs to be available from at least one location,
        then you can <code>get</code> what you want when you need it,
        and <code>drop</code> the rest.
    </div>
</section>


  <section>
      <h2>Git versus Git-annex</h2>
      <dl>
          <dt>Data in datasets is either stored in Git or git-annex</dt>
          <dd>By default, everything is <i>annexed</i>, i.e., stored in a dataset annex by git-annex</dd><br>
      <img height="500" src="../pics/artwork/src/publishing/publishing_gitvsannex.svg">
          <br><br>
          <li class="fragment fade-in-then-semi-out">With annexed data, only content identity (hash)
              and location information is put into Git, rather than file content.
              The annex, and transport to and from it is managed with <b>git-annex</b>
      </dl>
  </section>

  <section>
      <h3>Summary - Dataset consumption & nesting</h3>

      <ul>
        <dt class="fragment fade-in"><code>datalad clone</code> installs a dataset.</dt><dd class="fragment fade-in"> It can be installed “on its own”:
        Specify the source (url, path, ...) of the dataset, and an optional <b>path</b> for it to be installed to.</dd>
        <br>
        <dt class="fragment fade-in">Datasets can be installed as subdatasets within an existing dataset. </dt> <dd class="fragment fade-in"> The <b>--dataset/-d</b> option needs a path to the root of the superdataset.</dd>
        <br>
        <dt class="fragment fade-in">Only small files and metadata about file availability are present locally after an install. </dt>
          <dd class="fragment fade-in">To retrieve actual file content of annexed files,
              <code>datalad get </code> downloads file content on demand.</dd>
        <br>
        <dt class="fragment fade-in">Datasets preserve their history.</dt> <dd class="fragment fade-in">The superdataset records only the <i>version state</i> of the subdataset.</dd>

      </ul>
  </section>
</section>

<section>
<section style="text-align: left;">
    <h3>...Computationally reproducible execution...</h3>

    Try to execute the downloaded analysis script. Does it work?
            <div><pre style="margin-left: 0;"><code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                python code/classification_analysis.py</code></pre></div>

    <ul class="fragment">
        Software containers TODO
    </ul>
</section>

<section style="text-align: left;">
    <h3>...Computationally reproducible execution...</h3>
    <ul>
        <li class="fragment fade-in-then-semi-out">The <code>datalad run</code>
            can run any command in a way that links the command or script to the
            results it produces and the data it was computed from</li>
        <li class="fragment fade-in-then-semi-out">The <code>datalad rerun</code>
            can take this recorded provenance and recompute the command</li>
        <li class="fragment fade-in-then-semi-out">The <code>datalad containers-run</code>
            (from the extension "datalad-container") can capture software provenance in the form of software containers in addition to the provenance that datalad run captures</li>
    </ul>
    <br><br>

</section>


<section style="text-align: left;">
    <h3>...Computationally reproducible execution</h3>

    <div class="fragment">
        With the <code>datalad-container</code> extension, we can add software containers
        to datasets and work with them.
        Let's add a software container with Python software to run the script
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
               datalad containers-add python-env --url shub://adswa/resources:2
            </code>
        </pre>
    </div>


<div class="fragment">
        inspect the list of registered containers:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad containers-list
            </code>
        </pre>
    </div>

    <div class="fragment">
    Now, let's try out the <code>containers-run</code> command:
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
datalad containers-run -m "run classification analysis in python environment" \
  --container-name python-env \
  --input "input/iris.csv" \
  --output "pairwise_relationships.png" \
  --output "prediction_report.csv" \
  "python3 code/classification_analysis.py {inputs} {outputs}"
        </code>
    </pre>
    </div>
    <div class="fragment">
        What changed after the <code>containers-run</code> command has completed?
        <br>
        We can use <code>datalad diff</code> (based on <code>git diff</code>):
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad diff -f HEAD~1
            </code>
        </pre>
    </div>

    <div class="fragment">
        We see that some files were added to the dataset!
        <br>
        And we have a complete provenance record as part of the git history:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                git log -n 1
            </code>
        </pre>
    </div>
</section>


<section>
    <h3 style="text-align: left;">Publishing datasets...</h3>
    <div style="margin-top:1em;">
        <table style="border: none;">
            <tr>
                <td><img style="width: 800px; margin-right:1px;margin-bottom:10px;vertical-align:middle;" data-src="../pics/comic_box6_publishing.svg" /></td>
                <td><img style="width: 1000px; margin-right:1px;margin-bottom:10px;vertical-align:middle;" data-src="../pics/comic_box9.svg" /></td>
            </tr>
        </table>
    </div>
    <br>
    <div class="fragment">We will use GIN: <a href="https://gin.g-node.org/" target="_blank">gin.g-node.org</a>:</div>
    <br>
    <ul>
        <li class="fragment">Create a GIN user account and log in</li>
        <li class="fragment">
            <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent?platform=linux" target="_blank">
                Create</a> and
            <a href="https://handbook.datalad.org/en/latest/basics/101-139-gin.html#prerequisites" target="_blank">
                upload</a> an SSH key to GIN</li>
        <li class="fragment">Publish your dataset!</li>
    </ul>
</section>


<section style="text-align: left;">
    <h3>...Publishing datasets</h3>

    DataLad has convenience functions to create <code>sibling</code>-repositories
    on various third party services (GitHub, GitLab, OSF, WebDAV-based services, DataVerse, ...)
    , to which data can then be published with <code>push</code>.
    <pre style="margin-left: 0;">
        <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
            datalad create-sibling-gin example-analysis --access-protocol ssh
        </code>
    </pre>

    <div class="fragment">
        You can verify the dataset's siblings with the <code>siblings</code> command:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad siblings
            </code>
        </pre>
    </div>

    <div class="fragment">
        And we can push our complete dataset (Git repository and annex) to GIN:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad push --to gin
            </code>
        </pre>
    </div>
</section>


<section style="text-align: left;">
    <h3>Using published data...</h3>

    Let's see how the analysis feels like to others:
    <br><br>
    <pre style="margin-left: 0;">
        <code class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">cd ../
datalad clone \
   https://gin.g-node.org/adswa/example-analysis \
   myclone</code>
    </pre>

    <div class="fragment">
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                cd myclone
            </code>
        </pre>
    </div>

    <div class="fragment">
        Get results:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad get prediction_report.csv
            </code>
        </pre>
    </div>
    <div class="fragment">
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad drop prediction_report.csv
            </code>
        </pre>
    </div>

    <div class="fragment">
        Or recompute results:
        <pre style="margin-left: 0;">
            <code data-trim class="language-bash" onmousemove="showHover(event)" onmousedown="clickCopy(event)" onmouseleave="leaveElement(event)">
                datalad rerun
            </code>
        </pre>
    </div>
</section>
</section>

<section>
    <section>
        <h3>Wrap-up: How does this relate to reproducibility?</h3>
    </section>

<section data-transition="None">
    <h2>Exhaustive tracking</h2>
    <dl style="font-size:35px">
        <dt>The building blocks of a scientific result are rarely static</dt>
            <table>
                <tr>
                    <td style="vertical-align:middle">Data changes <br>
                        <small>(errors are fixed, data is extended,<br>
                            naming standards change, an analysis <br>
                                requires only a subset of your data...)</small></td>
                    <td><img src="../pics/phd052810s.png" height="500">
                    <imgcredit>Piled Higher and Deeper
                        <a href="https://phdcomics.com/comics/archive_print.php?comicid=1323" target="_blank">
                            1323
                        </a> </imgcredit></td>
                </tr>
            </table>
    </dl>
</section>


<section data-transition="None">
    <h2>Exhaustive tracking</h2>
    "Shit, which version of which script produced these outputs from which version
    of what data... and which software version?"<br>
    <img src="../pics/manuallabor.png">
    <img src="../pics/findfiles.png" height="400">
    <img src="../pics/projectstack.png" height="350">
    <imgcredit>CC-BY Scriberia and <a href="https://the-turing-way.netlify.app/reproducible-research/rdm.html" target="_blank">
        The Turing Way</a>
    </imgcredit>
</section>


<section data-transition="None">
    <h3>Exhaustive tracking</h3>
    Once you track changes to data with version control tools,
    you can find out <em>why</em> it changed, <em>what</em> has changed, <em>when</em> it changed,
    and <em>which version</em> of your data was used at which point in time.
    <div class="r-stack">
        <img class="fragment fade-out" data-fragment-index="1" src="../pics/tigdata.png">
        <img class="fragment" data-fragment-index="1" src="../pics/tigdata3.png">
        <img class="fragment" src="../pics/tigdata2.png">
    </div>
</section>

  <section>
      <h2>Digital provenance</h2>
      <ul>
          <p >
              = <i>"The tools and processes used to create a
              digital file, the responsible entity, and when and where the process
              events occurred"</i>
          </p>
          <li class="fragment fade-in">
              Have you ever saved a PDF to read later onto your computer, but forgot
              where you got it from? Or did you ever find a figure in your project,
              but forgot which analysis step produced it?
          </li>
      </ul>
  </section>

      <section data-transition="None">
        <h3>Security and reliability - for data</h3>
        Decentral version control for data integrates with a variety of services
        to let you store data in different places - creating a resilient network for data
        <img src="../pics/decentral_RDM_overview_left.png">
        <small> <a href="https://doi.org/10.1515/nf-2020-0037" target="_blank">"In defense of decentralized Research Data Management", doi.org/10.1515/nf-2020-0037</a> </small>
    </section>

    <section data-transition="None">
        <h3>Collaboration</h3>
        Teamscience on more than code:
        <img src="../pics/teamscience.png">
        <img class="fragment" src="../pics/datahistory.png">
    </section>
</section>


  <section>
      <h2>Basic organizational principles for datasets</h2>
      <dl>
          <dt>Keep everything clean and modular</dt>
          <li>An analysis is a superdataset, its components are subdatasets, and its structure modular</li>
          <table>
              <tr>
                  <td style="vertical-align:middle"><img src="../pics/dataset_modules.png" height="400"></td>
                  <td style="vertical-align:middle"><pre><code class="bash" style="max-height:none">├── code/
  │   ├── tests/
  │   └── myscript.py
  ├── docs
  │   ├── build/
  │   └── source/
  ├── envs
  │   └── Singularity
  ├── inputs/
  │   └─── data/
  │       ├── dataset1/
  │       │   └── datafile_a
  │       └── dataset2/
  │           └── datafile_a
  ├── outputs/
  │   └── important_results/
  │       └── figures/
  └── README.md</code></pre></td>
              </tr>
          </table>

      </dl>
      <ul>
      <li>do not touch/modify raw data: save any results/computations <i>outside</i> of input datasets</li>
      <li>Keep a superdataset self-contained: Scripts reference subdatasets or files with <i>relative paths</i></li>
      </ul>
  </section>

  <section>
      <h2>Basic organizational principles for datasets</h2>
      <dl>
          <dt>Record where you got it from, where it is now, and what you do to it</dt>
          <li>Link datasets (as subdatasets), record data origin</li>
          <li>Collect and store provenance of all contents of a dataset that you create</li>
              <table style="vertical-a-lign:middle">
                  <tr><img src="../pics/dataset_linkage_provenance.png"></tr>
              </table>
          <dl>
              <dt>Document everything:</dt>
              <li>Which script produced which output? From which data? In which software environment? ... </li>
          </dl>
      </dl>
      <note>Find out more about organizational principles in
          <a href="" target="_blank">the YODA principles</a>!</note>
  </section>

</section>





<section>
    <h2>Thank you for your attention!</h2>

    <img src="../pics/qr_lovedata.png" height="400">
<br><br><small>

    Slides: <a href="https://doi.org/10.5281/zenodo.7627723" target="_blank">
    DOI 10.5281/zenodo.7627723</a> (Scan the QR code)
    <br><br>
    </small>
    <table>
        <tr>
        </tr>
        <tr style="vertical-align:middle">
         <td style="vertical-align:middle">
             <img src="../pics/winrepo.png">
         </td>
            <td style="font-size: 18px">
                <br><br>
                Women neuroscientists are <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/ejn.14397" target="_blank">
                underrepresented in neuroscience</a>. You can use the <br>
                <a href="https://www.winrepo.org/" target="_blank"> Repository for Women in Neuroscience</a> to find
                and recommend neuroscientists for <br>
                conferences, symposia or collaborations, and help making neuroscience more open & divers.
            </td>
        </tr>

    </table>
</section>

<section>
  <h2>Acknowledgements</h2>
  <table>
  <tr style="vertical-align:middle">
    <td style="vertical-align:middle">
      <dl>
        <dt style="margin-top:20px">DataLad software <br>
            & ecosystem</dt>
        <dd style="margin-left:5px!important">
          <ul style="margin-left:5px!important">
              <li>Psychoinformatics Lab, <br>
              Research center Jülich</li>
              <li>Center for Open <br>
              Neuroscience, <br>
              Dartmouth College</li>
              <li>Joey Hess (git-annex)</li>
              <li><em>>100 additional contributors</em></li>
          </ul>
        </dd>
    </td>
    <td style="vertical-align:middle">
  <div style="margin-bottom:-20px;text-align:center"><strong>Funders</strong></div>
  <img style="height:150px;margin-right:50px" data-src="../pics/nsf.png" />
  <img style="height:150px;margin-right:50pxi;margin-left:50px" data-src="../pics/binc.png" />
  <img style="height:150px;margin-left:50px" data-src="../pics/bmbf.png" />
  <div style="margin-top:-20px">
  <img style="height:80px;margin-top:-40px;margin-left:40px" data-src="../pics/fzj_logo.svg" />
  <img style="height:60px;margin-left:50px;margin-bottom:25px" data-src="../pics/dfg_logo.png" />
  </div>
  <div style="margin-top:-20px">
  <img style="height:60px;margin-right:20px" data-src="../pics/erdf.png" />
  <img style="height:60px;margin-right:20px" data-src="../pics/cbbs_logo.png" />
  <img style="height:60px" data-src="../pics/LSA-Logo.png" />
  </div>
  <div style="margin-top:40px;margin-bottom:20px;text-align:center"><strong>Collaborators</strong></div>
  <div style="margin-top:-20px">
  <img style="height:100px;margin:20px" data-src="../pics/hbp_logo.png" />
  <img style="height:100px;margin:20px" data-src="../pics/conp_logo.png" />
  <img style="height:120px;margin:10px" data-src="../pics/openneuro_logo.png" />
  </div>
  <div style="margin-top:-40px">
  <img style="height:100px;margin:20px" data-src="../pics/ebrains-logo.png"/>
  <img style="height:100px;margin:0px" data-src="../pics/gin-logo.png" />
  <img style="height:120px;margin:10px" data-src="../pics/sfb1451_logo.png" />
</div>
  <div style="margin-top:-40px;align:middle">
  <img style="height:140px;margin:10px" data-src="../pics/brainlife_logo.png" />
  <img style="height:100px;margin:0px" data-src="../pics/cbrain_logo.png" />
  <img style="height:100px;margin:20px" data-src="../pics/vbc_logo.png" />
  </div>
  </td>
  </tr>
  </table>
</section>

</section>


			</div>
		</div>

		<script src="../reveal.js/dist/reveal.js"></script>
		<script src="../reveal.js/plugin/notes/notes.js"></script>
		<script src="../reveal.js/plugin/markdown/markdown.js"></script>
		<script src="../reveal.js/plugin/highlight/highlight.js"></script>
        <script src="../custom_functions.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				// The "normal" size of the presentation, aspect ratio will be preserved
				// when the presentation is scaled to fit different resolutions. Can be
				// specified using percentage units.
				width: 1280,
				height: 960,
				// Factor of the display size that should remain empty around the content
				margin: 0.3,
				// Bounds for smallest/largest possible scale to apply to content
				minScale: 0.2,
				maxScale: 1.0,

				controls: true,
				progress: true,
				history: true,
				center: true,
				slideNumber: 'c',
				pdfSeparateFragments: false,
				pdfMaxPagesPerSlide: 1,
				pdfPageHeightOffset: -1,
				transition: 'slide', // none/fade/slide/convex/concave/zoom
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>
